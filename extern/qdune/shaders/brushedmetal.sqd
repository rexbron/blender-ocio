# QDSLC version 0.0.1-alpha
surface brushedmetal
param uniform float Ks 0.9
param uniform float Ka 1
param uniform float uroughness 0.15
param uniform float vroughness 0.5
param uniform float Kd 0.1
temp varying float cos_theta_r
temp varying vector Y
temp varying color C
temp varying normal Nf
temp varying vector X
temp varying vector LN
temp varying float rho
temp varying color spec
temp varying float cos_theta_i
temp varying float nonspec
temp varying vector H
temp varying float $1
temp uniform float $2
temp varying float $3
temp varying float $4
temp varying float $5
temp varying vector $6
temp varying bool $7
temp varying vector $8
temp varying vector $9
temp varying vector $10
temp varying vector $11
const float $12 0
const float $13 1
const float $14 4
const string $15 "__nonspecular"
const float $16 0.0001
const float $17 1.5707963268
const float $18 -2
global dPdu Ci Oi Cl I L N P Cs Os
codesegment
	normalize        $11 N
	faceforward1     Nf $11 I
	normalize        $11 dPdu
	normalize        $9 I
	negvv            $9 $9
	vdot             $5 Nf $9
	clampf           cos_theta_r $5 $16 $13
	divvvf           X $11 uroughness
	vcross           $10 Nf $11
	divvvf           Y $10 vroughness
	movvf            C $12
@1
	illuminance2     P Nf $17 @2
	movff            nonspec $12
	ifltff           $7 nonspec $13
	cond_push        $7
	normalize        LN L
	vdot             cos_theta_i LN Nf
	ifgtff           $7 cos_theta_i $12
	cond_push        $7
	addvvv           $10 $9 LN
	normalize        H $10
	vdot             $5 X H
	mulfff           $3 $5 $5
	vdot             $4 Y H
	mulfff           $1 $4 $4
	addfff           $4 $3 $1
	mulfff           $4 $18 $4
	vdot             $1 H Nf
	addfff           $1 $13 $1
	divfff           $4 $4 $1
	exp              $4 $4
	mulfff           $1 cos_theta_i cos_theta_r
	sqrt             $1 $1
	divfff           rho $4 $1
	mulfff           $4 $13 cos_theta_i
	mulfff           $4 $4 rho
	maddvvf          C Cl $4
	cond_pop
	cond_pop
	jmp              @1
@2
	mulfff           $2 $14 uroughness
	mulfff           $2 $2 vroughness
	divvvf           spec C $2
	ambient          $8
	mulvvf           $8 $8 Ka
	diffuse          $6 Nf
	maddvvf          $8 $6 Kd
	mulvvf           $6 spec Ks
	addvvv           $8 $8 $6
	mulvvv           Ci Cs $8
	movvv            Oi Os
	mulvvv           Ci Ci Oi
	return
