# Original source:
# displacement bumpy( ﬂoat Km = 1;
#        string texturename = "";)
# {
#    ﬂoat amp = Km * ﬂoat texture(texturename, s, t);
#    P += amp * normalize(N);
#    N = calculatenormal(P);
# }
displacement bumpy
param float Km 1
param string texturename ""
temp float amp
temp normal $1
const string $2 ""
temp float $3
temp point $4
global P N s t
codesegment
	jeqss				texturename $2 @1
	texturef		amp texturename s t
	subfff			amp amp 0.5
	mulfff			amp amp 2
	mulfff			amp amp Km
	normalize		$1 N
	mulvvf			$1 $1 amp
	addvvv			P P $1
	calcnormal	N P
@1
	return
