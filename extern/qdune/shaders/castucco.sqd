# QDSLC version 0.0.1-alpha
displacement castucco
param uniform float freq 1
param uniform float octaves 3
param uniform float trough -0.15
param uniform float Km 0.2
param uniform float peak 0.35
temp uniform float i_1
temp varying point pp_1
temp varying float sum_1
temp varying float fw_1
temp uniform float amp_1
temp varying float spacescale_1
temp varying float disp
temp varying point Pshad
temp varying vector Ndisp_1
temp varying float fwidth
temp varying vector $1
temp varying float $2
temp varying float $3
temp uniform float $4
temp varying vector $5
const float $6 0
const float $7 1
const float $8 1e-06
const float $9 3
const string $10 "shader"
const float $11 0.75
const float $12 0.2
const float $13 0.6
const float $14 2
global P N
codesegment
	ptransform1      $5 $10 P
	mulvvf           Pshad $5 freq
	area             $2 Pshad
	sqrt             $2 $2
	maxf             fwidth $2 $8
	movff            amp_1 $7
	movvv            pp_1 Pshad
	movff            sum_1 $6
	movff            fw_1 fwidth
	movff            i_1 $6
@1
	jgeff            i_1 $9 @2
	noise3f          $2 pp_1
	mulfff           $2 $14 $2
	subfff           $2 $2 $7
	smoothstep       $3 $12 $11 fw_1
	subfff           $3 $7 $3
	mulfff           $2 $2 $3
	maddfff          sum_1 amp_1 $2
	mulfff           amp_1 amp_1 $13
	mulvvf           pp_1 pp_1 $14
	mulfff           fw_1 fw_1 $14
	addfff           i_1 i_1 $7
	jmp              @1
@2
	movff            disp sum_1
	smoothstep       $2 trough peak disp
	mulfff           disp Km $2
	normalize        $5 N
	vtransform1      $1 $10 $5
	length           spacescale_1 $1
	maxf             $3 spacescale_1 $8
	divfff           $3 disp $3
	mulvvf           Ndisp_1 $5 $3
	maddvvf          P Ndisp_1 $7
	subfff           $4 $7 $7
	mulvvf           $1 Ndisp_1 $4
	addvvv           $1 P $1
	calcnormal       $1 $1
	normalize        N $1
	return
