# QDSLC version 0.0.1-alpha
surface hair
param uniform float Ka 1
param uniform float Kd 0.6
param uniform color tipcolor 0.519 0.325 0.125
param uniform color rootcolor 0.109 0.037 0.007
param uniform float roughness 0.15
param uniform float Ks 0.35
param uniform color specularcolor 0.0 0.0 0.0
temp varying vector V
temp varying color Cspec
temp varying vector T
temp varying color Cdiff
temp varying float cosang
temp varying float $1
temp varying float $2
temp uniform float $3
temp varying vector $4
temp varying vector $5
temp varying vector $6
temp uniform vector $7
const float $8 0
const float $9 1
const float $10 2
global dPdv Oi Cl I L P Ci v Os
codesegment @1
	movvf            $7 $9
	addvvv           $7 $7 tipcolor
	divvvf           specularcolor $7 $10
@1
	normalize        T dPdv
	normalize        $6 I
	negvv            V $6
	movvf            Cspec $8
	movvf            Cdiff $8
@2
	illuminance1     P @3
	normalize        $6 L
	vdot             $2 T $6
	acos             $2 $2
	negvv            $4 T
	vdot             $1 $4 V
	acos             $1 $1
	subfff           $2 $2 $1
	abs              $2 $2
	cos              cosang $2
	mulvvf           $6 Cl v
	divfff           $3 $9 roughness
	pow              $1 cosang $3
	maddvvf          Cspec $6 $1
	maddvvf          Cdiff Cl v
	jmp              @2
@3
	movvv            Oi Os
	mixv             $6 rootcolor tipcolor v
	ambient          $4
	mulvvf           $4 $4 Ka
	mulvvf           $5 Cdiff Kd
	addvvv           $4 $4 $5
	mulvvv           $6 $6 $4
	mulvvf           $4 Cspec Ks
	maddvvv          $6 $4 specularcolor
	mulvvv           Ci Oi $6
	return
