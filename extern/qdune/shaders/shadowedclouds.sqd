# QDSLC version 0.0.1-alpha
surface shadowedclouds
param uniform float Ka 0.127
param uniform float Kd 1
param uniform float lightdensity 1
param uniform float stepsize 0.1
param uniform float shadstepsize 0.5
param uniform float opacdensity 1
param uniform float noisefreq 2.0
param uniform float shadowdensity 1
param uniform float radius 10.0
temp varying float last_dtau_1
temp uniform float i_3
temp varying float discrim
temp varying float discrim_1
temp varying float dtau
temp varying float fw_5
temp varying float end_1
temp varying float density_2
temp uniform float i_1
temp uniform float amp_5
temp varying float sum
temp varying float t1_2
temp varying float hits_1
temp varying float b
temp uniform float i_5
temp varying float sum_2
temp varying float ss_1
temp varying float ss_2
temp varying color lighttau
temp varying point Worigin
temp uniform float amp_1
temp varying float tau
temp varying float dtau_2
temp varying float Oi_2
temp uniform float i
temp varying float sum_1
temp varying float solutions
temp varying point pp_4
temp varying color Cscat_1
temp varying color Lscatter_1
temp varying float sum_4
temp varying float sum_5
temp varying point pp_5
temp varying float fw
temp varying float b_1
temp varying float t1
temp varying float t0
temp varying float c
temp varying point pp_2
temp varying point Pobj
temp varying float Llen
temp varying float solutions_1
temp varying point pp_1
temp varying float Oi_1
temp varying float tau_2
temp varying float t0_2
temp varying float last_dtau_2
temp varying vector Iobj
temp varying float t0_1
temp varying float c_1
temp varying float tau_1
temp uniform float i_2
temp varying float fw_4
temp varying float t1_1
temp varying float fw_2
temp varying float fw_1
temp varying float d
temp uniform float amp_4
temp varying float end_2
temp varying float dtau_1
temp varying float solutions_2
temp uniform float i_4
temp varying point pp
temp varying float d_2
temp varying float end
temp varying float Llen_1
temp varying point origin
temp varying float density_3
temp varying point Psamp
temp varying float b_2
temp varying float last_dtau
temp varying float ss
temp varying float density_1
temp varying float sum_3
temp varying float hits
temp varying float hits_2
temp uniform float amp_3
temp varying float density
temp varying color li
temp varying float d_1
temp varying point pp_3
temp varying float density_5
temp varying color Cscat
temp uniform float amp
temp varying float density_4
temp varying color Lscatter
temp varying color last_li
temp varying vector Iobj_2
temp varying vector Iobj_1
temp varying float discrim_2
temp varying float c_2
temp varying float fw_3
temp uniform float amp_2
temp uniform vector $1
temp varying bool $2
temp varying vector $3
temp varying vector $4
temp varying vector $5
temp varying float $6
temp varying float $7
temp varying float $8
temp uniform float $9
temp varying vector $10
temp varying vector $11
temp varying vector $12
temp varying vector $13
temp varying vector $14
temp uniform bool $15
temp varying vector $16
temp varying vector $17
temp uniform vector $18
temp varying vector $19
temp varying vector $20
temp varying vector $21
temp varying vector $22
temp varying vector $23
temp varying vector $24
temp uniform float $25
temp varying vector $26
temp uniform bool $27
temp varying float $28
temp varying float $29
temp varying float $30
temp uniform float $31
temp varying float $32
temp varying float $33
temp varying float $34
temp varying float $35
temp uniform float $36
temp varying float $37
temp uniform float $38
temp varying float $39
temp varying float $40
temp varying float $41
temp uniform float $42
temp varying float $43
temp varying float $44
temp varying bool $45
temp varying bool $46
temp varying float $47
temp uniform bool $48
temp varying bool $49
temp uniform float $50
temp varying float $51
temp uniform bool $52
temp varying bool $53
temp uniform bool $54
temp varying bool $55
temp uniform bool $56
temp varying float $57
temp varying float $58
temp uniform vector $59
temp varying vector $60
temp varying bool $61
temp uniform float $62
temp uniform float $63
const float $64 0
const float $65 1
const float $66 2
const float $67 4
const float $68 0.5
const float $69 7
const float $70 0.005
const float $71 0.75
const float $72 0.8
const float $73 0.2
const float $74 7.28
const float $75 0.0001
const float $76 0.65
const string $77 "current"
const string $78 "object"
global Ci Oi Cl I L N P
codesegment
	movvf            Oi $64
	movvv            Ci Oi
	vdot             $34 N I
	ifgtff           $45 $34 $64
	cond_push        $45
	ptransform1      Pobj $78 P
	vtransform1      $13 $78 I
	normalize        Iobj $13
	negvv            $13 Iobj
	vdot             $35 Pobj $13
	mulfff           b $66 $35
	vdot             $35 Pobj Pobj
	mulfff           $31 radius radius
	subfff           c $35 $31
	mulfff           $35 b b
	mulfff           $32 $67 c
	subfff           discrim $35 $32
	ifgtff           $46 discrim $64
	cond_push        $46
	sqrt             discrim discrim
	negff            $35 discrim
	subfff           $35 $35 b
	divfff           t0 $35 $66
	ifgtff           $46 t0 $75
	cond_push        $46
	subfff           $35 discrim b
	divfff           t1 $35 $66
	movff            solutions $66
	cond_else
	subfff           $35 discrim b
	divfff           t0 $35 $66
	ifgtff           $46 t0 $75
	cmovf            solutions $46 $65 $64
	cond_pop
	cond_else
	ifeqff           $46 discrim $64
	cond_push        $46
	negff            $35 b
	divfff           t0 $35 $66
	ifgtff           $46 t0 $75
	cmovf            solutions $46 $65 $64
	cond_else
	movff            solutions $64
	cond_pop
	cond_pop
	movff            hits solutions
	ifgtff           $46 hits $64
	cond_push        $46
	movff            $35 t0
	cond_else
	movff            $35 $64
	cond_pop
	movff            end $35
	mulvvf           $14 Iobj t0
	subvvv           origin Pobj $14
	ptransform2      Worigin $78 $77 origin
	randomf          $35
	mulfff           d $35 stepsize
	subfff           $35 end d
	minf             ss stepsize $35
	mulvvf           $14 Iobj d
	addvvv           Psamp origin $14
	mulfff           $36 stepsize noisefreq
	mulvvf           $11 Psamp noisefreq
	movff            amp $65
	movvv            pp $11
	movff            sum $64
	movff            fw $36
	movff            i $64
@1
	ifltff           $48 i $69
	cjmpnot          $48 @2
	noise3f          $33 pp
	mulfff           $33 $66 $33
	subfff           $33 $33 $65
	smoothstep       $30 $73 $71 fw
	subfff           $30 $65 $30
	mulfff           $33 $33 $30
	maddfff          sum amp $33
	mulfff           amp amp $76
	mulvvf           pp pp $66
	mulfff           fw fw $66
	addfff           i i $65
	jmp              @1
@2
	movff            $33 sum
	mulfff           $33 $68 $33
	addfff           density $68 $33
	clampf           $33 density $64 $65
	pow              density $33 $74
	length           $33 Psamp
	divfff           $33 $33 radius
	smoothstep       $33 $72 $65 $33
	subfff           $33 $65 $33
	mulfff           density density $33
	movff            last_dtau density
	ptransform2      $12 $78 $77 Psamp
	movvf            Lscatter $64
@3
	illuminance1     $12 @4
	movvv            Cscat Cl
	jleff            shadowdensity $64 @5
	vtransform1      $10 $78 L
	movff            Oi_1 $64
	length           Llen $10
	normalize        Iobj_1 $10
	vdot             $7 Psamp $10
	mulfff           b_1 $66 $7
	vdot             $7 Psamp Psamp
	mulfff           $42 radius radius
	subfff           c_1 $7 $42
	mulfff           $7 b_1 b_1
	mulfff           $43 $67 c_1
	subfff           discrim_1 $7 $43
	ifgtff           $49 discrim_1 $64
	cond_push        $49
	sqrt             discrim_1 discrim_1
	negff            $7 discrim_1
	subfff           $7 $7 b_1
	divfff           t0_1 $7 $66
	ifgtff           $49 t0_1 $75
	cond_push        $49
	subfff           $7 discrim_1 b_1
	divfff           t1_1 $7 $66
	movff            solutions_1 $66
	cond_else
	subfff           $7 discrim_1 b_1
	divfff           t0_1 $7 $66
	ifgtff           $49 t0_1 $75
	cmovf            solutions_1 $49 $65 $64
	cond_pop
	cond_else
	ifeqff           $49 discrim_1 $64
	cond_push        $49
	negff            $7 b_1
	divfff           t0_1 $7 $66
	ifgtff           $49 t0_1 $75
	cmovf            solutions_1 $49 $65 $64
	cond_else
	movff            solutions_1 $64
	cond_pop
	cond_pop
	movff            hits_1 solutions_1
	ifgtff           $49 hits_1 $64
	cond_push        $49
	movff            $7 t0_1
	cond_else
	movff            $7 $64
	cond_pop
	movff            end_1 $7
	minf             end_1 end_1 Llen
	movff            d_1 $64
	subfff           $7 end_1 d_1
	minf             ss_1 shadstepsize $7
	mulfff           $9 shadstepsize noisefreq
	mulvvf           $22 Psamp noisefreq
	movff            amp_1 $65
	movvv            pp_1 $22
	movff            sum_1 $64
	movff            fw_1 $9
	movff            i_1 $64
@7
	ifltff           $52 i_1 $69
	cjmpnot          $52 @8
	noise3f          $44 pp_1
	mulfff           $44 $66 $44
	subfff           $44 $44 $65
	smoothstep       $41 $73 $71 fw_1
	subfff           $41 $65 $41
	mulfff           $44 $44 $41
	maddfff          sum_1 amp_1 $44
	mulfff           amp_1 amp_1 $76
	mulvvf           pp_1 pp_1 $66
	mulfff           fw_1 fw_1 $66
	addfff           i_1 i_1 $65
	jmp              @7
@8
	movff            $44 sum_1
	mulfff           $44 $68 $44
	addfff           density_1 $68 $44
	clampf           $44 density_1 $64 $65
	pow              density_1 $44 $74
	length           $44 Psamp
	divfff           $44 $44 radius
	smoothstep       $44 $72 $65 $44
	subfff           $44 $65 $44
	mulfff           density_1 density_1 $44
	movff            last_dtau_1 density_1
@9
	ifleff           $53 d_1 end_1
	cjmpnot          $53 @10
	cond_push        $53
	subfff           $44 end_1 d_1
	clampf           ss_1 ss_1 $70 $44
	addfff           d_1 d_1 ss_1
	mulvvf           $23 Iobj_1 d_1
	addvvv           $23 Psamp $23
	mulfff           $50 shadstepsize noisefreq
	mulvvf           $21 $23 noisefreq
	movff            amp_2 $65
	movvv            pp_2 $21
	movff            sum_2 $64
	movff            fw_2 $50
	movff            i_2 $64
@11
	ifltff           $54 i_2 $69
	cjmpnot          $54 @12
	noise3f          $39 pp_2
	mulfff           $39 $66 $39
	subfff           $39 $39 $65
	smoothstep       $40 $73 $71 fw_2
	subfff           $40 $65 $40
	mulfff           $39 $39 $40
	maddfff          sum_2 amp_2 $39
	mulfff           amp_2 amp_2 $76
	mulvvf           pp_2 pp_2 $66
	mulfff           fw_2 fw_2 $66
	addfff           i_2 i_2 $65
	jmp              @11
@12
	movff            $39 sum_2
	mulfff           $39 $68 $39
	addfff           density_2 $68 $39
	clampf           $39 density_2 $64 $65
	pow              density_2 $39 $74
	length           $39 $23
	divfff           $39 $39 radius
	smoothstep       $39 $72 $65 $39
	subfff           $39 $65 $39
	mulfff           density_2 density_2 $39
	movff            dtau density_2
	mulfff           $39 shadowdensity ss_1
	divfff           $39 $39 $66
	addfff           $40 dtau last_dtau_1
	mulfff           tau $39 $40
	negff            $39 tau
	exp              $39 $39
	subfff           $39 $65 $39
	maddfff          Oi_1 $65 $39
	movff            last_dtau_1 dtau
	cond_pop
	jmp              @9
@10
	movff            $39 Oi_1
	subfff           $39 $65 $39
	mulvvf           Cscat Cscat $39
@5
	addvvv           Lscatter Lscatter Cscat
	jmp              @3
@4
	movvf            $18 $65
	mulvvv           last_li Lscatter $18
@13
	ifleff           $55 d end
	cjmpnot          $55 @14
	cond_push        $55
	subfff           $39 end d
	clampf           ss ss $70 $39
	addfff           d d ss
	mulvvf           $19 Iobj d
	addvvv           Psamp origin $19
	mulfff           $38 stepsize noisefreq
	mulvvf           $20 Psamp noisefreq
	movff            amp_3 $65
	movvv            pp_3 $20
	movff            sum_3 $64
	movff            fw_3 $38
	movff            i_3 $64
@15
	ifltff           $56 i_3 $69
	cjmpnot          $56 @16
	noise3f          $37 pp_3
	mulfff           $37 $66 $37
	subfff           $37 $37 $65
	smoothstep       $29 $73 $71 fw_3
	subfff           $29 $65 $29
	mulfff           $37 $37 $29
	maddfff          sum_3 amp_3 $37
	mulfff           amp_3 amp_3 $76
	mulvvf           pp_3 pp_3 $66
	mulfff           fw_3 fw_3 $66
	addfff           i_3 i_3 $65
	jmp              @15
@16
	movff            $37 sum_3
	mulfff           $37 $68 $37
	addfff           density_3 $68 $37
	clampf           $37 density_3 $64 $65
	pow              density_3 $37 $74
	length           $37 Psamp
	divfff           $37 $37 radius
	smoothstep       $37 $72 $65 $37
	subfff           $37 $65 $37
	mulfff           density_3 density_3 $37
	movff            dtau_1 density_3
	ptransform2      $17 $78 $77 Psamp
	movvf            Lscatter_1 $64
@17
	illuminance1     $17 @18
	movvv            Cscat_1 Cl
	jleff            shadowdensity $64 @19
	vtransform1      $16 $78 L
	movff            Oi_2 $64
	length           Llen_1 $16
	normalize        Iobj_2 $16
	vdot             $6 Psamp $16
	mulfff           b_2 $66 $6
	vdot             $6 Psamp Psamp
	mulfff           $62 radius radius
	subfff           c_2 $6 $62
	mulfff           $6 b_2 b_2
	mulfff           $51 $67 c_2
	subfff           discrim_2 $6 $51
	ifgtff           $61 discrim_2 $64
	cond_push        $61
	sqrt             discrim_2 discrim_2
	negff            $6 discrim_2
	subfff           $6 $6 b_2
	divfff           t0_2 $6 $66
	ifgtff           $61 t0_2 $75
	cond_push        $61
	subfff           $6 discrim_2 b_2
	divfff           t1_2 $6 $66
	movff            solutions_2 $66
	cond_else
	subfff           $6 discrim_2 b_2
	divfff           t0_2 $6 $66
	ifgtff           $61 t0_2 $75
	cmovf            solutions_2 $61 $65 $64
	cond_pop
	cond_else
	ifeqff           $61 discrim_2 $64
	cond_push        $61
	negff            $6 b_2
	divfff           t0_2 $6 $66
	ifgtff           $61 t0_2 $75
	cmovf            solutions_2 $61 $65 $64
	cond_else
	movff            solutions_2 $64
	cond_pop
	cond_pop
	movff            hits_2 solutions_2
	ifgtff           $61 hits_2 $64
	cond_push        $61
	movff            $6 t0_2
	cond_else
	movff            $6 $64
	cond_pop
	movff            end_2 $6
	minf             end_2 end_2 Llen_1
	movff            d_2 $64
	subfff           $6 end_2 d_2
	minf             ss_2 shadstepsize $6
	mulfff           $63 shadstepsize noisefreq
	mulvvf           $26 Psamp noisefreq
	movff            amp_4 $65
	movvv            pp_4 $26
	movff            sum_4 $64
	movff            fw_4 $63
	movff            i_4 $64
@21
	ifltff           $15 i_4 $69
	cjmpnot          $15 @22
	noise3f          $58 pp_4
	mulfff           $58 $66 $58
	subfff           $58 $58 $65
	smoothstep       $8 $73 $71 fw_4
	subfff           $8 $65 $8
	mulfff           $58 $58 $8
	maddfff          sum_4 amp_4 $58
	mulfff           amp_4 amp_4 $76
	mulvvf           pp_4 pp_4 $66
	mulfff           fw_4 fw_4 $66
	addfff           i_4 i_4 $65
	jmp              @21
@22
	movff            $58 sum_4
	mulfff           $58 $68 $58
	addfff           density_4 $68 $58
	clampf           $58 density_4 $64 $65
	pow              density_4 $58 $74
	length           $58 Psamp
	divfff           $58 $58 radius
	smoothstep       $58 $72 $65 $58
	subfff           $58 $65 $58
	mulfff           density_4 density_4 $58
	movff            last_dtau_2 density_4
@23
	ifleff           $2 d_2 end_2
	cjmpnot          $2 @24
	cond_push        $2
	subfff           $58 end_2 d_2
	clampf           ss_2 ss_2 $70 $58
	addfff           d_2 d_2 ss_2
	mulvvf           $5 Iobj_2 d_2
	addvvv           $5 Psamp $5
	mulfff           $25 shadstepsize noisefreq
	mulvvf           $3 $5 noisefreq
	movff            amp_5 $65
	movvv            pp_5 $3
	movff            sum_5 $64
	movff            fw_5 $25
	movff            i_5 $64
@25
	ifltff           $27 i_5 $69
	cjmpnot          $27 @26
	noise3f          $47 pp_5
	mulfff           $47 $66 $47
	subfff           $47 $47 $65
	smoothstep       $57 $73 $71 fw_5
	subfff           $57 $65 $57
	mulfff           $47 $47 $57
	maddfff          sum_5 amp_5 $47
	mulfff           amp_5 amp_5 $76
	mulvvf           pp_5 pp_5 $66
	mulfff           fw_5 fw_5 $66
	addfff           i_5 i_5 $65
	jmp              @25
@26
	movff            $47 sum_5
	mulfff           $47 $68 $47
	addfff           density_5 $68 $47
	clampf           $47 density_5 $64 $65
	pow              density_5 $47 $74
	length           $47 $5
	divfff           $47 $47 radius
	smoothstep       $47 $72 $65 $47
	subfff           $47 $65 $47
	mulfff           density_5 density_5 $47
	movff            dtau_2 density_5
	mulfff           $47 shadowdensity ss_2
	divfff           $47 $47 $66
	addfff           $57 dtau_2 last_dtau_2
	mulfff           tau_1 $47 $57
	negff            $47 tau_1
	exp              $47 $47
	subfff           $47 $65 $47
	maddfff          Oi_2 $65 $47
	movff            last_dtau_2 dtau_2
	cond_pop
	jmp              @23
@24
	movff            $47 Oi_2
	subfff           $47 $65 $47
	mulvvf           Cscat_1 Cscat_1 $47
@19
	addvvv           Lscatter_1 Lscatter_1 Cscat_1
	jmp              @17
@18
	movvf            $1 $65
	mulvvv           li Lscatter_1 $1
	mulfff           $47 opacdensity ss
	divfff           $47 $47 $66
	addfff           $57 dtau_1 last_dtau
	mulfff           tau_2 $47 $57
	mulfff           $47 lightdensity ss
	divfff           $47 $47 $66
	mulvvf           $60 li dtau_1
	mulvvf           $24 last_li last_dtau
	addvvv           $60 $60 $24
	mulvvf           lighttau $60 $47
	movvf            $1 $65
	subvvv           $60 $1 Oi
	maddvvv          Ci $60 lighttau
	movvf            $59 $65
	subvvv           $24 $59 Oi
	negff            $28 tau_2
	exp              $28 $28
	subfff           $28 $65 $28
	maddvvf          Oi $24 $28
	movff            last_dtau dtau_1
	movvv            last_li li
	cond_pop
	jmp              @13
@14
	return
